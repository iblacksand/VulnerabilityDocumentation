# Vulnerability Documentation

This is the documentation to test vulnerabilities in password managers found in the paper [Analysis on the Security and Use of Password Managers](https://www.overleaf.com/read/gtxjfrdntkyq). We have found five successful attacks that exploit vulnerabilities in Passbolt, Padlock and Encryptr.

### Attacks

* [Userscripts](#userscripts)
    * [Passbolt Fake Extension Installer](#passbolt-fake-extension-installer)
    * [Padlock Data Reset](#padlock-data-reset)
    * [Padlock Access Remover](#padlock-access-remover)
* [User Input Attacks](#user-input-attacks)
    * [Keylogger Attack](#keylogger-attack)
    * [Clipboard Reader](#clipboard-reader)
    * [Installation](#installation)
    * [Setup](#setup)

## Userscripts

Before you start using any of the userscript attacks, you need to use a userscript manager.

For Chrome, use [Tampermonkey](https://tampermonkey.net/).

For Firefox, use [Greasemonkey](https://addons.mozilla.org/en-US/firefox/addon/greasemonkey/)

### Installing Scripts

Tampermonkey and Greasemonkey should automatically install the userscripts when you click the given install link. If you have trouble installing any userscript look at the wiki for your userscript manager.

Tampermonkey - [https://tampermonkey.net/faq.php#Q102](https://tampermonkey.net/faq.php#Q102)

Greasemonkey - [https://wiki.greasespot.net/Greasemonkey_Manual:Installing_Scripts](https://wiki.greasespot.net/Greasemonkey_Manual:Installing_Scripts).

Firefox is preferred because all the scripts will execute fully on Firefox.

### Passbolt Fake Extension Installer

[**Install**](https://github.com/iblacksand/VulnerabilityDocumentation/raw/master/PassboltFakeExtensionInstaller.user.js)

This script will change all links that download the passbolt extension to download a random script(we choose [NoScript](https://addons.mozilla.org/en-US/firefox/addon/noscript/)). For the full effect you should use Firefox with Greasemonkey(See [Userscripts](#userscripts) for more info). 

After you install the program

### Padlock Data Reset

### Padlock Access Remover

## User Input Attacks

Both user input attacks were built in C# for use only on Windows devices. They work in much the same way. Both of the attacks save plain-text logs with timestamps. Every 10 minutes, the attacks send the logs to our email and delete them from the victim's computer.

### Keylogger Attack

The keylogger saves every key press and click into a plain-text file. It attaches a timestamp at the beginning of each log and after 30 seconds of inactivity.

### Clipboard Reader

The clipboard reader checks once every second to see if the contents of the clipboard have changed. Every time it detects a change, it logs the timestamp and clipboard contents.

### Installation

Both of these attacks can be hidden in the installation of a different program and set up to run every time Windows boots up. For our purposes, we combined both attacks into a single installation.

In order to test, first download one of the below files:
* Manual-start program: \<insert link here>
* Windows-startup installer: \<insert link here>

If you download the manual-start, skip to [Setup](#setup)

If you download the installer, the files will be saved in the following location:
\
`C:\Users\<WINDOWS ACCOUNT NAME>\AppData\Local\Fake Microsoft Process`

### Setup